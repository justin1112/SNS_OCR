# OCR-based Privacy-Aware Image Masking (Hybrid Rule + NLP)

## 1. Problem Statement

SNS에 사진을 업로드할 때 사용자는 이미지 속 모든 텍스트를 인지하지 못한 채  
개인정보(전화번호, 주소, 이름 등)를 노출하는 경우가 많다.  
본 프로젝트는 **자연 이미지 속 텍스트를 자동으로 인식하고,  
개인정보로 판단되는 영역만 선택적으로 비식별화**하는 것을 목표로 한다.

---

## 2. Overall Pipeline

본 시스템은 다음과 같은 파이프라인으로 구성된다.



OCR은 수단이며, 핵심 목표는 **개인정보 보호를 위한 합리적인 판단 구조 설계**이다.

---

## 3. OCR & Text Detection

- EasyOCR을 사용하여 이미지 내 텍스트 영역(bounding box)을 탐지하고 문자열을 인식하였다.
- 한글과 영어가 혼합된 자연 이미지 환경을 가정하였다.
- OCR 결과는 `(bbox, text, confidence)` 형태로 처리된다.

---

## 4. Rule-based Candidate Detection

규칙 기반 탐지는 개인정보 여부를 **확정하는 단계가 아니라,  
개인정보일 가능성이 있는 후보를 빠르게 식별하는 단계**로 사용된다.

탐지 대상 예시는 다음과 같다.
- 전화번호
- 주민등록번호
- 차량 번호
- 주소 키워드

이 단계에서는 **True/False 판결을 내리지 않고**,  
패턴이 감지된 항목을 후보(hits)로만 기록한다.

---

## 5. NLP-based Semantic Validation (spaCy)

규칙 기반 탐지 결과가 애매한 경우에 한해  
spaCy 기반 Named Entity Recognition(NER)을 적용하였다.

- PERSON: 개인 식별 가능 → 개인정보
- ORG: 기관/단체 → 비개인정보
- LOC/GPE: 위치 정보 → 개인정보 가능성 있음

NLP는 단독 판결자가 아니라,  
**규칙 기반 탐지의 오탐을 보완하는 의미 검증 단계**로 활용된다.

---

## 6. Hybrid Decision Logic (Core Idea)

본 프로젝트의 핵심은 **Rule과 NLP의 역할 분리**이다.

- Rule: 개인정보 후보 탐지 (의심 제기)
- NLP: 의미 기반 검증 (최종 판결)

최종 모자이크 여부는 다음 기준으로 결정된다.
- Rule에서 탐지되지 않으면 → 비식별화하지 않음
- Rule에서 탐지되고, NLP에서 개인정보 의미가 확인되면 → 비식별화
- Rule만 탐지되고 NLP에서 의미가 부정되면 → 비식별화하지 않음

또한 각 판단에 대해 **왜 모자이크 되었는지에 대한 reason을 함께 기록**하여  
설명 가능성과 디버깅 용이성을 확보하였다.

---

## 7. Selective Mosaic Masking

- 개인정보로 판단된 텍스트 영역에 대해서만 bounding box 기반 모자이크를 적용하였다.
- OCR bounding box의 불완전성을 고려하여 padding을 적용하였다.
- 불필요한 과도한 비식별화를 방지하는 것을 우선 목표로 삼았다.

---

## 8. Failure Cases & Fix

### Address Keyword False Positive
- 주소 키워드(시/구/동 등)로 인해 일반 문장이 개인정보로 오인되는 문제가 발생하였다.
- Rule을 최종 판결에서 제외하고, NLP 의미 검증을 결합하여 문제를 해결하였다.

### Mixed Content Bounding Box
- 이름과 직함, 기관명이 하나의 bbox로 인식되는 경우가 있었다.
- 의미 단위(NER)를 기준으로 개인정보 여부를 판단하도록 설계를 수정하였다.

이 과정에서 **실패를 숨기지 않고 구조적으로 해결하는 데 집중**하였다.

---

## 9. Extension Possibilities

본 구조는 다음과 같은 확장이 가능하다.
- 송장 번호(Tracking Number) 탐지
- 여권 번호 탐지 (국가별 패턴 확장)
- 개인정보 위험도 기반 비식별화 강도 조절
- 자동 실패 사례 수집 및 분석 리포트 생성

---

## 10. Conclusion

본 프로젝트는 단순한 OCR 결과 처리에 그치지 않고,  
**규칙 기반 탐지와 NLP 기반 의미 검증을 결합한 hybrid 구조를 통해  
안정성과 설명 가능성을 동시에 확보한 개인정보 비식별화 시스템**을 구현하였다.

OCR 환경의 불완전성을 고려한 설계와  
판단 근거를 명확히 드러내는 구조를 통해  
실제 서비스 적용 가능성을 염두에 둔 프로젝트를 지향하였다.





OCR은 수단이며, 핵심 목표는 **개인정보 보호를 위한 합리적인 판단 구조 설계**이다.

---

## 3. OCR & Text Detection

- EasyOCR을 사용하여 이미지 내 텍스트 영역(bounding box)을 탐지하고 문자열을 인식하였다.
- 한글과 영어가 혼합된 자연 이미지 환경을 가정하였다.
- OCR 결과는 `(bbox, text, confidence)` 형태로 처리된다.

---

## 4. Rule-based Candidate Detection

규칙 기반 탐지는 개인정보 여부를 **확정하는 단계가 아니라,  
개인정보일 가능성이 있는 후보를 빠르게 식별하는 단계**로 사용된다.

탐지 대상 예시는 다음과 같다.
- 전화번호
- 주민등록번호
- 차량 번호
- 주소 키워드

이 단계에서는 **True/False 판결을 내리지 않고**,  
패턴이 감지된 항목을 후보(hits)로만 기록한다.

---

## 5. NLP-based Semantic Validation (spaCy)

규칙 기반 탐지 결과가 애매한 경우에 한해  
spaCy 기반 Named Entity Recognition(NER)을 적용하였다.

- PERSON: 개인 식별 가능 → 개인정보
- ORG: 기관/단체 → 비개인정보
- LOC/GPE: 위치 정보 → 개인정보 가능성 있음

NLP는 단독 판결자가 아니라,  
**규칙 기반 탐지의 오탐을 보완하는 의미 검증 단계**로 활용된다.

---

## 6. Hybrid Decision Logic (Core Idea)

본 프로젝트의 핵심은 **Rule과 NLP의 역할 분리**이다.

- Rule: 개인정보 후보 탐지 (의심 제기)
- NLP: 의미 기반 검증 (최종 판결)

최종 모자이크 여부는 다음 기준으로 결정된다.
- Rule에서 탐지되지 않으면 → 비식별화하지 않음
- Rule에서 탐지되고, NLP에서 개인정보 의미가 확인되면 → 비식별화
- Rule만 탐지되고 NLP에서 의미가 부정되면 → 비식별화하지 않음

또한 각 판단에 대해 **왜 모자이크 되었는지에 대한 reason을 함께 기록**하여  
설명 가능성과 디버깅 용이성을 확보하였다.

---

## 7. Selective Mosaic Masking

- 개인정보로 판단된 텍스트 영역에 대해서만 bounding box 기반 모자이크를 적용하였다.
- OCR bounding box의 불완전성을 고려하여 padding을 적용하였다.
- 불필요한 과도한 비식별화를 방지하는 것을 우선 목표로 삼았다.

---

## 8. Failure Cases & Fix

### Address Keyword False Positive
- 주소 키워드(시/구/동 등)로 인해 일반 문장이 개인정보로 오인되는 문제가 발생하였다.
- Rule을 최종 판결에서 제외하고, NLP 의미 검증을 결합하여 문제를 해결하였다.

### Mixed Content Bounding Box
- 이름과 직함, 기관명이 하나의 bbox로 인식되는 경우가 있었다.
- 의미 단위(NER)를 기준으로 개인정보 여부를 판단하도록 설계를 수정하였다.

이 과정에서 **실패를 숨기지 않고 구조적으로 해결하는 데 집중**하였다.

---

## 9. Extension Possibilities

본 구조는 다음과 같은 확장이 가능하다.
- 송장 번호(Tracking Number) 탐지
- 여권 번호 탐지 (국가별 패턴 확장)
- 개인정보 위험도 기반 비식별화 강도 조절
- 자동 실패 사례 수집 및 분석 리포트 생성

---

## 10. Conclusion

본 프로젝트는 단순한 OCR 결과 처리에 그치지 않고,  
**규칙 기반 탐지와 NLP 기반 의미 검증을 결합한 hybrid 구조를 통해  
안정성과 설명 가능성을 동시에 확보한 개인정보 비식별화 시스템**을 구현하였다.
